<!doctype html>
<html>
<head>
<title>Listener</title>
<script src="resources/jquery-1.9.1.min.js" type="text/javascript"></script>
<script type="text/javascript">
$(document).ready(function() {
    loadSessions();
    $(document).on("click", ".session", function() {
        var id=$(this).attr("title")
        activateSession(id);
    });
});

function loadSessions() {
    $("#sessions").empty()
    $.getJSON("/sessions", function(sessions) {
        sessions.forEach(function(sess) {
            var li = $("<li></li>").appendTo("#sessions");
            $("<a href='#'></a>").addClass("session").attr("title", sess).html(sess).appendTo(li);
        });
    });
}
var socket=null;
function activateSession(id) {
    if (socket!=null) {
      socket.close();
    }
    var url = "ws://" + window.location.host + "/audio/" + id;
    socket = new WebSocket(url);
    var node = new AudioSourceNode()
    var audioOutput = new Audio();
}
</script>
</head>

<body>
    <h1>Listener</h1>
    <ul id="sessions">

    </ul>
    <a href="#" onclick="loadsessions();">Reload sessions</a>

</body>

</html>
